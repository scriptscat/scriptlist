{
    "swagger": "2.0",
    "info": {
        "title": "脚本站 API 文档",
        "version": "2.0.0"
    },
    "basePath": "/api/v2",
    "paths": {
        "/login/oauth": {
            "get": {
                "description": "第三方登录",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "user"
                ],
                "summary": "第三方登录",
                "parameters": [
                    {
                        "type": "string",
                        "name": "code",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "name": "redirect_uri",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/user.OAuthCallbackResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts": {
            "get": {
                "description": "获取脚本列表",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "获取脚本列表",
                "parameters": [
                    {
                        "type": "string",
                        "name": "keyword",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "0:全部 1: 脚本 2: 库 3: 后台脚本 4: 定时脚本",
                        "name": "script_type,default=0",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "name": "sort,default=today_download",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.ListResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            },
            "post": {
                "description": "创建脚本",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "创建脚本",
                "parameters": [
                    {
                        "name": "body",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/script.CreateRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.CreateResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts/migrate/es": {
            "post": {
                "description": "全量迁移数据到es",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "全量迁移数据到es",
                "parameters": [
                    {
                        "name": "body",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/script.MigrateEsRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.MigrateEsResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts/{id}": {
            "get": {
                "description": "获取脚本信息",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "获取脚本信息",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.InfoResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts/{id}/code": {
            "get": {
                "description": "获取脚本代码信息",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "获取脚本代码信息",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.CodeResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            },
            "put": {
                "description": "更新脚本/库代码",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "更新脚本/库代码",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/script.UpdateCodeRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.UpdateCodeResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts/{id}/state": {
            "get": {
                "description": "获取脚本状态,脚本关注等",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "获取脚本状态,脚本关注等",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.StateResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts/{id}/versions": {
            "get": {
                "description": "获取版本列表",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "获取版本列表",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.VersionListResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts/{id}/versions/{version}/code": {
            "get": {
                "description": "获取指定版本代码",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "获取指定版本代码",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "name": "version",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.VersionCodeResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/scripts/{id}/watch": {
            "post": {
                "description": "关注脚本",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "script"
                ],
                "summary": "关注脚本",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "body",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/script.WatchRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/script.WatchResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/users": {
            "get": {
                "description": "获取当前登录的用户信息",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "user"
                ],
                "summary": "获取当前登录的用户信息",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/user.CurrentUserResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        },
        "/users/{uid}/info": {
            "get": {
                "description": "获取指定用户信息",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "user"
                ],
                "summary": "获取指定用户信息",
                "parameters": [
                    {
                        "type": "integer",
                        "name": "uid",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "properties": {
                                "code": {
                                    "type": "integer"
                                },
                                "data": {
                                    "$ref": "#/definitions/user.InfoResponse"
                                },
                                "msg": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/BadRequest"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "BadRequest": {
            "type": "object",
            "properties": {
                "code": {
                    "description": "错误码",
                    "type": "integer",
                    "format": "int32"
                },
                "msg": {
                    "description": "错误信息",
                    "type": "string"
                }
            }
        },
        "httputils.PageRequest": {
            "type": "object",
            "properties": {
                "limit,default=20": {
                    "type": "integer"
                },
                "page,default=1": {
                    "type": "integer"
                }
            }
        },
        "httputils.PageResponse": {
            "type": "object",
            "properties": {
                "list": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "$ref": "#/definitions/script.Script"
                    }
                },
                "total": {
                    "type": "integer"
                }
            }
        },
        "model.AdminLevel": {
            "description": "AdminLevel enum type:\n- Admin: 1\n- SuperModerator: 2\n- Moderator: 3",
            "type": "integer",
            "enum": [
                1,
                2,
                3
            ]
        },
        "script.CodeResponse": {
            "type": "object",
            "properties": {
                "archive": {
                    "type": "integer"
                },
                "avatar": {
                    "type": "string"
                },
                "category": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/script.ScriptCategoryList"
                    }
                },
                "content,omitempty": {
                    "type": "string"
                },
                "createtime": {
                    "type": "integer"
                },
                "description": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "post_id": {
                    "type": "integer"
                },
                "public": {
                    "type": "integer"
                },
                "score": {
                    "type": "integer"
                },
                "score_num": {
                    "type": "integer"
                },
                "script": {
                    "$ref": "#/definitions/script.ScriptCode"
                },
                "status": {
                    "type": "integer"
                },
                "today_install": {
                    "type": "integer"
                },
                "total_install": {
                    "type": "integer"
                },
                "type": {
                    "type": "integer"
                },
                "unwell": {
                    "type": "integer"
                },
                "updatetime": {
                    "type": "integer"
                },
                "user_id": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                }
            }
        },
        "script.CreateRequest": {
            "type": "object",
            "properties": {
                "changelog": {
                    "type": "string"
                },
                "code": {
                    "type": "string"
                },
                "content": {
                    "type": "string"
                },
                "definition": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "public": {
                    "description": "公开类型：1 公开 2 半公开",
                    "$ref": "#/definitions/script_entity.Public"
                },
                "type": {
                    "description": "脚本类型：1 用户脚本 2 脚本引用库 3 订阅脚本(不支持)",
                    "$ref": "#/definitions/script_entity.Type"
                },
                "unwell": {
                    "description": "不适内容: 1 不适 2 适用",
                    "$ref": "#/definitions/script_entity.UnwellContent"
                },
                "version": {
                    "type": "string"
                }
            }
        },
        "script.CreateResponse": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer"
                }
            }
        },
        "script.InfoResponse": {
            "type": "object",
            "properties": {
                "archive": {
                    "type": "integer"
                },
                "avatar": {
                    "type": "string"
                },
                "category": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/script.ScriptCategoryList"
                    }
                },
                "content,omitempty": {
                    "type": "string"
                },
                "createtime": {
                    "type": "integer"
                },
                "description": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "post_id": {
                    "type": "integer"
                },
                "public": {
                    "type": "integer"
                },
                "score": {
                    "type": "integer"
                },
                "score_num": {
                    "type": "integer"
                },
                "script": {
                    "$ref": "#/definitions/script.ScriptCode"
                },
                "status": {
                    "type": "integer"
                },
                "today_install": {
                    "type": "integer"
                },
                "total_install": {
                    "type": "integer"
                },
                "type": {
                    "type": "integer"
                },
                "unwell": {
                    "type": "integer"
                },
                "updatetime": {
                    "type": "integer"
                },
                "user_id": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                }
            }
        },
        "script.ListResponse": {
            "type": "object",
            "properties": {
                "list": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "$ref": "#/definitions/script.Script"
                    }
                },
                "total": {
                    "type": "integer"
                }
            }
        },
        "script.MigrateEsRequest": {
            "type": "object"
        },
        "script.MigrateEsResponse": {
            "type": "object"
        },
        "script.Script": {
            "type": "object",
            "properties": {
                "archive": {
                    "type": "integer"
                },
                "avatar": {
                    "type": "string"
                },
                "category": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/script.ScriptCategoryList"
                    }
                },
                "content,omitempty": {
                    "type": "string"
                },
                "createtime": {
                    "type": "integer"
                },
                "description": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "post_id": {
                    "type": "integer"
                },
                "public": {
                    "type": "integer"
                },
                "score": {
                    "type": "integer"
                },
                "score_num": {
                    "type": "integer"
                },
                "script": {
                    "$ref": "#/definitions/script.ScriptCode"
                },
                "status": {
                    "type": "integer"
                },
                "today_install": {
                    "type": "integer"
                },
                "total_install": {
                    "type": "integer"
                },
                "type": {
                    "type": "integer"
                },
                "unwell": {
                    "type": "integer"
                },
                "updatetime": {
                    "type": "integer"
                },
                "user_id": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                }
            }
        },
        "script.ScriptCategoryList": {
            "type": "object",
            "properties": {
                "createtime": {
                    "type": "integer"
                },
                "id": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "num": {
                    "description": "本分类下脚本数量",
                    "type": "integer"
                },
                "sort": {
                    "type": "integer"
                },
                "updatetime": {
                    "type": "integer"
                }
            }
        },
        "script.ScriptCode": {
            "type": "object",
            "properties": {
                "avatar": {
                    "type": "string"
                },
                "changelog": {
                    "type": "string"
                },
                "code,omitempty": {
                    "type": "string"
                },
                "createtime": {
                    "type": "integer"
                },
                "definition,omitempty": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "meta,omitempty": {
                    "type": "string"
                },
                "meta_json": {
                    "type": "object"
                },
                "script_id": {
                    "type": "integer"
                },
                "status": {
                    "type": "integer"
                },
                "user_id": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                },
                "version": {
                    "type": "string"
                }
            }
        },
        "script.StateResponse": {
            "type": "object",
            "properties": {
                "watch": {
                    "$ref": "#/definitions/script_entity.ScriptWatchLevel"
                }
            }
        },
        "script.UpdateCodeRequest": {
            "type": "object",
            "properties": {
                "changelog": {
                    "type": "string"
                },
                "code": {
                    "type": "string"
                },
                "content": {
                    "type": "string"
                },
                "definition": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "public": {
                    "description": "公开类型：1 公开 2 半公开",
                    "$ref": "#/definitions/script_entity.Public"
                },
                "unwell": {
                    "$ref": "#/definitions/script_entity.UnwellContent"
                },
                "version": {
                    "description": "Name string `form:\"name\" binding:\"max=128\" label:\"库的名字\"`\nDescription string `form:\"description\" binding:\"max=102400\" label:\"库的描述\"`",
                    "type": "string"
                }
            }
        },
        "script.UpdateCodeResponse": {
            "type": "object"
        },
        "script.VersionCodeResponse": {
            "type": "object",
            "properties": {
                "archive": {
                    "type": "integer"
                },
                "avatar": {
                    "type": "string"
                },
                "category": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/script.ScriptCategoryList"
                    }
                },
                "content,omitempty": {
                    "type": "string"
                },
                "createtime": {
                    "type": "integer"
                },
                "description": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "post_id": {
                    "type": "integer"
                },
                "public": {
                    "type": "integer"
                },
                "score": {
                    "type": "integer"
                },
                "score_num": {
                    "type": "integer"
                },
                "script": {
                    "$ref": "#/definitions/script.ScriptCode"
                },
                "status": {
                    "type": "integer"
                },
                "today_install": {
                    "type": "integer"
                },
                "total_install": {
                    "type": "integer"
                },
                "type": {
                    "type": "integer"
                },
                "unwell": {
                    "type": "integer"
                },
                "updatetime": {
                    "type": "integer"
                },
                "user_id": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                }
            }
        },
        "script.VersionListResponse": {
            "type": "object",
            "properties": {
                "list": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "$ref": "#/definitions/script.Script"
                    }
                },
                "total": {
                    "type": "integer"
                }
            }
        },
        "script.WatchRequest": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer"
                },
                "watch": {
                    "$ref": "#/definitions/script_entity.ScriptWatchLevel"
                }
            }
        },
        "script.WatchResponse": {
            "type": "object"
        },
        "script_entity.Public": {
            "description": "Public enum type:\n- PublicScript: 1\n- PrivateScript: 2",
            "type": "integer",
            "enum": [
                1,
                2
            ]
        },
        "script_entity.ScriptWatchLevel": {
            "description": "ScriptWatchLevel enum type:\n- ScriptWatchLevelNone: 1\n- ScriptWatchLevelVersion: 2\n- ScriptWatchLevelIssue: 3\n- ScriptWatchLevelIssueComment: 4",
            "type": "integer",
            "enum": [
                1,
                2,
                3,
                4
            ]
        },
        "script_entity.Type": {
            "description": "Type enum type:\n- UserscriptType: 1\n- SubscribeType: 2\n- LibraryType: 3",
            "type": "integer",
            "enum": [
                1,
                2,
                3
            ]
        },
        "script_entity.UnwellContent": {
            "description": "UnwellContent enum type:\n- Unwell: 1\n- Well: 2",
            "type": "integer",
            "enum": [
                1,
                2
            ]
        },
        "user.CurrentUserResponse": {
            "type": "object",
            "properties": {
                "avatar": {
                    "type": "string"
                },
                "email_status": {
                    "type": "integer"
                },
                "is_admin": {
                    "$ref": "#/definitions/model.AdminLevel"
                },
                "uid": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                }
            }
        },
        "user.InfoResponse": {
            "type": "object",
            "properties": {
                "avatar": {
                    "type": "string"
                },
                "email_status": {
                    "type": "integer"
                },
                "is_admin": {
                    "$ref": "#/definitions/model.AdminLevel"
                },
                "uid": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                }
            }
        },
        "user.OAuthCallbackResponse": {
            "type": "object",
            "properties": {
                "redirect_uri": {
                    "type": "string"
                },
                "uid": {
                    "type": "integer"
                }
            }
        },
        "user_entity.UserInfo": {
            "type": "object",
            "properties": {
                "avatar": {
                    "type": "string"
                },
                "user_id": {
                    "type": "integer"
                },
                "username": {
                    "type": "string"
                }
            }
        }
    }
}